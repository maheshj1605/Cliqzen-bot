// ------------------------------------------------------
// CliqZen Bot - Install Handler (Advanced Version)
// Runs when the bot is installed for the first time
// ------------------------------------------------------

user = install_action.get("user");
username = user.get("name");

// Log install event
info "üöÄ CliqZen Bot Installed by: " + username;


// ------------------------------------------------------
// Default Settings Setup
// ------------------------------------------------------
defaultSettings = Map();
defaultSettings.put("workspace_mode", "team");
defaultSettings.put("default_priority", "medium");


// ------------------------------------------------------
// Save Default Settings to Catalyst DB
// ------------------------------------------------------
try
{
	resp = invokeurl
	[
		url :"https://YOUR_CATALYST_DOMAIN/server/saveSettings"
		type :POST
		body:defaultSettings
		content-type:"application/json"
		connection:"cliqzen_catalyst_connection"
	];

	info "‚úÖ Default settings stored successfully.";
}
catch(e)
{
	info "‚ùå Failed to store default settings: " + e.toString();
}


// ------------------------------------------------------
// Welcome Card UI
// ------------------------------------------------------
card = Map();
card.put("theme", "modern");
card.put("title", "üéâ Welcome to CliqZen Bot!");

introText = "Your smart AI-powered task assistant is now installed.\n\n";
usageText = "Use `/create`, `/tasks`, `/search`, or open the bot menu.";

card.put("sub_title", introText + usageText);

return card;
